# 공유 카드 MVP 설계 문서

## 목표
- 기록 저장 직후 바텀시트로 “공유” 유도
- SNS 친화적인 이미지 카드 생성(Story 1080×1920 기준)
- MVP는 **템플릿 1(한 줄 감상 카드)**만 제공

---

## 결정 사항
- **노출 타이밍**: 기록 저장 후 “공유 카드 만들기” 체크 시만 표시
- **평점 표기**: 문구 + 1자리 점수(예: 5.0) 표시
  - 공유 설정 토글로 포함/제외 선택
- **메모**: 공유 설정에서 포함/제외 토글, 줄바꿈 2줄까지 유지
- **워터마크**: 정식 모드 `On the Timeline`, 레트로 모드 `으뜸과 버금`
- **출력 사이즈**: 1080×1920 (Story)만
- **포스터**: 시즌 포스터 우선, 없으면 기본 포스터 사용

---

## UX 플로우
1) QuickLog 저장 성공 → 체크된 경우 바텀시트 오픈
2) 바텀시트 내용
   - 카드 미리보기(템플릿 1)
   - 토글: 평점 문구 표시 / 메모 포함
   - 버튼: `이미지 저장`, `공유하기`
3) 공유 방식
   - 모바일: Web Share API(이미지 파일)
   - 데스크탑: 이미지 다운로드

---

## 템플릿(현재 적용)
### 구성
- 상단 70%: 포스터 영역
- 하단 30%: 텍스트 패널(제목/메모/메타 칩)
- 메타 칩: 상태/평점/날짜
- 좌하단: 워터마크

### 문구 예시
- 작품명: Dune: Part Two
- 한 줄: 사막에서 숨이 멎을 뻔
- 하단: 봤어요 · 2026.01.17

### 규칙
- 메모는 2줄까지만 유지, 나머지는 … 처리
- 제목은 `:` 뒤에서 줄바꿈
- 날짜는 `YYYY.MM.DD` 포맷

---

## 컴포넌트/모듈 설계(초안)
### 컴포넌트
- `ShareBottomSheet`
  - props: `open`, `log`, `onClose`
  - 내부에 카드 미리보기 + 토글 + 버튼
- `ShareCardTemplate1`
  - props: `log`, `showRatingLabel`, `showNote`
  - 카드 렌더(Story size)

### 유틸
- `renderShareCardToImage(node): Promise<Blob>`
  - DOM → 캔버스 변환
  - 결과 Blob을 저장/공유에 사용

---

## 기술 선택
### vercel/og (Satori) - 채택
- **방식**: 서버 사이드에서 이미지 렌더링
- **장점**: 모바일/데스크탑 동일 품질, CORS 이슈 적음
- **단점**: CSS 제한, 폰트 파일 필요

---

## 현재 구현 상태
- `ShareBottomSheet` 구현 완료
- 서버 이미지 렌더 API `/api/share-card` 적용
- 공유 버튼: 웹/PWA 모두 노출
- 링크 복사/카드 내 링크 표시는 제거

---

## 후속 확장
- 템플릿 2(포스터 중심)
- 템플릿 3(월간 발자취)
- 피드 비율(1080×1350) 출력
- 공유 히스토리/통계
